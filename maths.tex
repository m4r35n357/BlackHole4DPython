\documentclass[11pt]{article}
%Gummi|063|=)
\title{\textbf{Visualizing Special Relativity}}
\author{Ian Smith}
\date{}
\begin{document}

\maketitle

\abstract
A simple method for generating 4D geodesics for matter and light in the Kerr spacetime.

\section{Bound Orbits in the Kerr Spacetime}

\subsection {Equations of motion}

This is the set of equations in terms of the constants of motion; $E$ (energy), $L$ (equatorial angular momentum), and $Q$ (Carter's constant):

$$
(r^2 + a^2 \cos^2\theta) \frac{d t}{d \tau} = \frac{d t}{d \lambda} = \frac{(r^2 + a^2) ((r^2 + a^2) E - aL)} {({r}^{2} - 2rM  + {a}^{2})} + a(L - aE \sin^2 \theta)
$$
$$
(r^2 + a^2 \cos^2\theta) \frac{d r}{d \tau} = \frac{d r}{d \lambda} = \pm \sqrt R
$$
$$
(r^2 + a^2 \cos^2\theta) \frac{d \theta}{d \tau} = \frac{d \theta}{d \lambda} = \pm \sqrt \Theta
$$
$$
(r^2 + a^2 \cos^2\theta) \frac{d \phi}{d \tau}= \frac{d \phi}{d \lambda} = \frac{a ((r^2 + a^2) E - aL)} {({r}^{2} - 2rM  + {a}^{2})} + (\frac {L} {\sin^2 \theta} -aE)
$$

These are essentially equations (2) and (3) fom Wilkins [], fully expanded except for the potentials $R$ and $\Theta$, which , together with their differentials, are defined below.

Notice also the use of "Mino" time, $\lambda$, to render the $R$ and $\Theta$ equations mutually independent.  In terms of Mino time, the potentials are simply the squares of the $r$ and $\theta$ velocities.

$$
\lambda = \frac {\tau} {(r^2 + a^2 \cos^2\theta)}
$$
$$
R = ((r^2 + a^2) E - aL)^2 - (r^2 - 2rM  + a^{2}) ( Q+{\left( L - aE\right) }^{2}+{\mu}^{2}{r}^{2})
$$
$$
\frac{d R}{d r} = \left( 2\,r - 2\,M\right) \,\left( Q+{\left( L - a\,E\right) }^{2}+{\mu}^{2}\,{r}^{2}\right) - 2\,{\mu}^{2}r({r}^{2} - 2rM  + {a}^{2}) +4\,r\,E\,\left( \left( {r}^{2}+{a}^{2}\right) \,E - a\,L\right)
$$
$$
\Theta=Q - {\mathrm{cos}\left( \theta\right) }^{2}\,\left( \frac{{L}^{2}}{{\mathrm{sin}\left( \theta\right) }^{2}}+{a}^{2}\,\left( {\mu}^{2} - {E}^{2}\right) \right)
$$
$$
\frac{d \Theta}{d \theta} = 2\,\mathrm{cos}\left( \theta\right) \,\mathrm{sin}\left( \theta\right) \,\left( \frac{{L}^{2}}{{\mathrm{sin}\left( \theta\right) }^{2}}+{a}^{2}\,\left( {\mu}^{2} - {E}^{2}\right) \right) +\frac{2\,{\mathrm{cos}\left( \theta\right) }^{3}\,{L}^{2}}{{\mathrm{sin}\left( \theta\right) }^{3}}
$$

The $t$ and $\phi$ equations can be evolved trivially using the Euler method, but the $R$ and $\Theta$ equations require a little more effort.  For these the Euler approach is hampered by the need to identify turning points [].  The approach described here is to use a symplectic Stormer-Verlet integrator [] to evolve the $R$ and $\Theta$ equations, which turns out to be a surprisingly simple solution.  This is possible because the potential equations are both of the form:

$$
\dot x^2 - V(x) = 0
$$

This expresison is used to quantify the integration errors, whilst the two differentiated potentials above are used for velocity updates in the integrator routines.

\section{Finding initial conditions}

The other difficulty in generating orbits is the problem of generating initial conditions.  Finding an intersting set is hard, partly because many combinations of the constants of motion are unphysical.

Here I present a straightforward way of generating bound orbits in three spatial dimensions.  It is based on solving the potential equations under various conditions using the constants of motion $E$, $L$, and $Q$ as variables.

\subsection{Constant radius ("spherical")}

For constant radius orbits at $r_0$, we are looking for a double root of the quartic $R$, in other words we want the radial velocity to be zero, and its differential to also be zero so that the radial speed remains zero during the orbit.  $\Theta$ will also be zero at the maximum deviation from equatorial. 

$$
R(r_0) = 0
$$
$$
\frac{d R(r_0)}{d r} = 0
$$
$$
\Theta(\theta_{MIN}) = 0
$$

\subsection{Variable radius ("spherical shell")}

For variable radius orbits we are looking for two distinct roots of the quartic $R$, in other words that the orbit is bound between two $r$ values, $r_1$ and $r_2$.  The $\Theta$ condition is unchanged from the constant $R$ case.

$$
\frac{d R(r_1)}{d r} = 0
$$
$$
\frac{d R(r_2)}{d r} = 0
$$
$$
\Theta(\theta_{MIN}) = 0
$$

\subsection{Finding the roots}

These equations can of course be solved by various root-finding techniques, but the equations and algorithms can often become messy and potentially error-prone, with no easy way to check intermediate results.  For this work I took a simpler approach, forming a sum-of-squares error function, minimizing it, and making sure it is equal to zero.  I found the Nelder-Mead algorithm from Scipy converges reliably from zero initial conditions on $E$, $L$, and $Q$.

The generation script then writes an initial conditions file (including the final values of $E$, $L$, and $Q$) in JSON format for the integrator.


\end{document}

