#!/bin/sh

initialConditions=$1
time=$2
nPoints=$3
shift 3
coordinates=$*

dataFile='/tmp/data'

# run simulator
if [ -f ./bh3d ]
then
    ./bh3d <$initialConditions >$dataFile 2>errors
else
    ./bh3d.py <$initialConditions >$dataFile 2>errors
fi

# plot potential, coordinates/velocities (optional) and errors
./filepotential.py potential &
for coordinate in $coordinates
do
	./phase.py $dataFile $time $nPoints $coordinate &
	./interpolate.py $dataFile $time $nPoints $coordinate &
done
./errorchart.py $dataFile $time $nPoints &

# plot orbit
case $(uname -m) in
    armv7l) ./filegraphics-pi.py $dataFile $initialConditions;;
    x86_64) ./filegraphics.py $dataFile $initialConditions $time $nPoints &;;
esac

